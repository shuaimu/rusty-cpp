[env]
# Z3 header location for macOS with Homebrew
Z3_SYS_Z3_HEADER = "/opt/homebrew/include/z3.h"

# For Linux, uncomment and adjust:
# Z3_SYS_Z3_HEADER = "/usr/include/z3.h"

[target.aarch64-apple-darwin]
# macOS ARM64 (Apple Silicon) specific settings
rustflags = [
    "-C", "link-arg=-Wl,-rpath,@executable_path/../lib",
    "-C", "link-arg=-Wl,-rpath,@loader_path/../lib", 
    "-C", "link-arg=-Wl,-rpath,/opt/homebrew/lib",
    "-C", "link-arg=-Wl,-rpath,/opt/homebrew/Cellar/llvm/19.1.7/lib"
]

[target.x86_64-apple-darwin]
# macOS Intel specific settings
rustflags = [
    "-C", "link-arg=-Wl,-rpath,@executable_path/../lib",
    "-C", "link-arg=-Wl,-rpath,@loader_path/../lib",
    "-C", "link-arg=-Wl,-rpath,/usr/local/lib",
    "-C", "link-arg=-Wl,-rpath,/opt/homebrew/Cellar/llvm/19.1.7/lib"
]

[target.x86_64-unknown-linux-gnu]
# Linux x86_64 settings
rustflags = [
    "-C", "link-arg=-Wl,-rpath,$ORIGIN/../lib",
    "-C", "link-arg=-Wl,-rpath,/usr/lib/llvm-14/lib",
    "-C", "link-arg=-Wl,-rpath,/usr/local/lib"
]

[target.aarch64-unknown-linux-gnu]
# Linux ARM64 settings  
rustflags = [
    "-C", "link-arg=-Wl,-rpath,$ORIGIN/../lib",
    "-C", "link-arg=-Wl,-rpath,/usr/lib/llvm-14/lib",
    "-C", "link-arg=-Wl,-rpath,/usr/local/lib"
]

# Profile for release builds - optimize for portability
[profile.release]
lto = true
codegen-units = 1
strip = true
opt-level = 3